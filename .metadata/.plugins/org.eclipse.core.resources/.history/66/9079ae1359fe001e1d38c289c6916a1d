package com.wcs.user.service;



import com.wcs.user.model.Deep_user;
import com.wcs.user.security.AESEncryptionUtil;
import com.wcs.user.security.UserRepository;

import lombok.RequiredArgsConstructor;

@RequiredArgsConstructor
public class UserServiceImpl implements UserService{
	
	private final UserRepository userRepository;

	@Override
	public void createUser(String username, String password) {
		Deep_user user = new Deep_user();
        user.setUserName(username);
        user.setPassword(AESEncryptionUtil.encrypt(password));
        userRepository.save(user);
    }
	
	@Override
    public Deep_user getUserByUsername(String username) {
        return userRepository.findByUserName(username);
    }

    public boolean authenticateUser(String username, String password) {
    	Deep_user user = userRepository.findByUserName(username);
        if (user != null && AESEncryptionUtil.decrypt(user.getPassword()).equals(password)) {
            return true;
        }
        return false;
    }
	
}
